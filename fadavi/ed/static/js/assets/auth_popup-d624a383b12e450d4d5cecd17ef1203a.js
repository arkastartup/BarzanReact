//# sourceMappingURL=auth_popup.js.map
var onLogin;$.ajaxSetup({beforeSend:function(c,b){b.url!=$("#ajaxLoginForm").attr("action")&&(onLogin=b.success)},statusCode:{401:function(){}}});
function showLogin(){var c=$(this).attr("data-redirecturl");"this"==c?$("#login_form, #verify_form").attr("data-redirect",""):c&&$("#login_form, #verify_form").attr("data-redirect",c);$(".popup_container").removeClass("show");$(".auth_popup").addClass("show");$("body").addClass("no_scroll");$(".auth_popup .popup_sections").removeClass("show");$(".auth_popup .login_section").addClass("show")}
$(function(){function c(b){b=$('meta[property="og:url"]').attr("content")+"/ajaxlog/"+b;$.get(b,function(b,a){console.log("loging result: "+b+"\nStatus: "+a)})}$(document.body).on("click",".goto-register",function(b){b.preventDefault();b=$(this).attr("data-redirecturl");"this"==b?$("#login_form, #verify_form").attr("data-redirect",""):b&&$("#login_form, #verify_form").attr("data-redirect",b);$(".popup_container").removeClass("show");$(".auth_popup").addClass("show");$("body").addClass("no_scroll");
$(".auth_popup .popup_sections").removeClass("show");$(".auth_popup .verify_section").hasClass("active")?$(".auth_popup .verify_section").addClass("show"):$(".auth_popup .register_section").addClass("show")});$(document.body).on("click",".goto-login",function(b){b.preventDefault();showLogin()});$(".view_login_password").click(function(){"password"==$(".auth_popup .login_password").attr("type")?$(".auth_popup .login_password").get(0).type="text":$(".auth_popup .login_password").get(0).type="password"});
$(".view_register_password").click(function(){"password"==$(".auth_popup .register_password").attr("type")?$(".auth_popup .register_password").get(0).type="text":$(".auth_popup .register_password").get(0).type="password"});$(".popup_container.auth_popup").on("click touchstart",function(b){if(0!=$(b.target).parents(".popup_close").length||$(b.target).hasClass("popup_close")||$(b.target).hasClass("popup_wrapper"))$(".popup_container.auth_popup").removeClass("show"),$("body").removeClass("no_scroll")});
$("#login_form").submit(function(b){b.preventDefault();b.stopImmediatePropagation();b=$(this).serializeArray();var d=$(this).attr("action");$.ajax({url:d,type:"POST",cache:!1,dataType:"json",data:b,beforeSend:function(){$(".auth_popup .login_section .popup_submit_btn").addClass("inprocess");$(".auth_popup .login_section .popup_submit_btn").prop("disabled",!0)},success:function(a){console.log(a);$.isEmptyObject(a.error)?(a=$("#login_form").attr("data-redirect"))?window.location.href=a:window.location.reload():
($(".auth_popup .login_section .popup_submit_btn").removeClass("inprocess"),$(".auth_popup .login_section .popup_submit_btn").prop("disabled",!1),$(".auth_popup .login_section .auth_formgroup,.main_error").removeClass("has-error"),$(".auth_popup .login_section .error-block,.main_error").text(""),console.log(a.error),$.isEmptyObject(a.error.mobile)||($(".auth_popup .login_section .mobile").addClass("has-error"),$(".auth_popup .login_section .mobile .error-block").text(a.error.mobile)),$.isEmptyObject(a.error.password)||
($(".auth_popup .login_section .password").addClass("has-error"),$(".auth_popup .login_section .password .error-block").text(a.error.password)))},error:function(a){console.log(a.responseText);c(encodeURI(a.responseText.slice(0,1500)));$(".auth_popup .login_section .popup_submit_btn").removeClass("inprocess");$(".auth_popup .login_section .popup_submit_btn").prop("disabled",!1);$(".auth_popup .login_section .auth_formgroup").removeClass("has-error");$(".auth_popup .login_section .error-block").text("");
$(".auth_popup .login_section .main_error").addClass("has-error");$(".auth_popup .login_section .main_error").text("\u062f\u0631 \u0627\u062a\u0635\u0627\u0644 \u0634\u0645\u0627 \u0628\u0647 \u0633\u0631\u0648\u0631 \u062e\u0637\u0627\u06cc\u06cc \u0631\u062e \u062f\u0627\u062f\u0647 \u0627\u0633\u062a! \u0644\u0637\u0641\u0627 \u0628\u0639\u062f \u0627\u0632 \u0628\u0627\u0631\u06af\u0630\u0627\u0631\u06cc \u0645\u062c\u062f\u062f \u0635\u0641\u062d\u0647 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f.");
setTimeout(function(){window.location.reload()},3E3)},timeout:6E4})});$("#signup_form").submit(function(b){b.preventDefault();b.stopImmediatePropagation();if($("#acceptrules").is(":checked"))$(".auth_popup .acceptrulescheck").removeClass("has-error");else return $(".auth_popup .acceptrulescheck").addClass("has-error"),setTimeout(function(){$(".auth_popup .acceptrulescheck").removeClass("has-error")},1E3),!1;b=$(this).serializeArray();var d=$(this).attr("action");$.ajax({url:d,type:"POST",cache:!1,
dataType:"json",data:b,beforeSend:function(){$(".auth_popup .register_section .popup_submit_btn").addClass("inprocess");$(".auth_popup .register_section .popup_submit_btn").prop("disabled",!0)},success:function(a){$(".auth_popup .register_section .popup_submit_btn").removeClass("inprocess");$(".auth_popup .register_section .popup_submit_btn").prop("disabled",!1);$(".auth_popup .register_section .auth_formgroup,.main_error").removeClass("has-error");$(".auth_popup .register_section .error-block,.main_error").text("");
$.isEmptyObject(a.error)?(a=[{name:"username",value:$("#signup_form #mobile").val()},{name:"password",value:$("#signup_form #password").val()},{name:"remember-me",value:"on"}],$.ajax({url:"/login/authenticate",type:"POST",cache:!1,dataType:"json",data:a,success:function(a){console.log(a);(a=$("#login_form").attr("data-redirect"))?window.location.href=a:window.location.reload()},error:function(a){console.log(a.responseText);setTimeout(function(){window.location.reload()},3E3)},timeout:6E4})):(console.log(a.error),
102==a.error&&($(".auth_popup .register_section .main_error").addClass("has-error"),$(".auth_popup .register_section .main_error").text("\u0628\u0647 \u062f\u0644\u0627\u06cc\u0644\u06cc \u0633\u06cc\u0633\u062a\u0645 \u0634\u0645\u0627 \u0631\u0627 \u0631\u0628\u0627\u062a \u062a\u0634\u062e\u06cc\u0635 \u062f\u0627\u062f\u0647! \u0627\u06af\u0631 \u0627\u0646\u0633\u0627\u0646 \u0647\u0633\u062a\u06cc\u062f \u0644\u0637\u0641\u0627 \u0645\u062c\u062f\u062f\u0627 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f.")),
$.isEmptyObject(a.error.name)||($(".auth_popup .register_section .name").addClass("has-error"),$(".auth_popup .register_section .name .error-block").text(a.error.name)),$.isEmptyObject(a.error.lastname)||($(".auth_popup .register_section .lastname").addClass("has-error"),$(".auth_popup .register_section .lastname .error-block").text(a.error.lastname)),$.isEmptyObject(a.error.mobile)||($(".auth_popup .register_section .mobile").addClass("has-error"),$(".auth_popup .register_section .mobile .error-block").text(a.error.mobile)),
$.isEmptyObject(a.error.password)||($(".auth_popup .register_section .password").addClass("has-error"),$(".auth_popup .register_section .password .error-block").text(a.error.password)))},error:function(a){console.log(a.responseText);c(encodeURI(a.responseText.slice(0,1500)));$(".auth_popup .register_section .popup_submit_btn").removeClass("inprocess");$(".auth_popup .register_section .popup_submit_btn").prop("disabled",!1);$(".auth_popup .register_section .auth_formgroup").removeClass("has-error");
$(".auth_popup .register_section .error-block").text("");$(".auth_popup .register_section .main_error").addClass("has-error");$(".auth_popup .register_section .main_error").text("\u062f\u0631 \u0627\u062a\u0635\u0627\u0644 \u0634\u0645\u0627 \u0628\u0647 \u0633\u0631\u0648\u0631 \u062e\u0637\u0627\u06cc\u06cc \u0631\u062e \u062f\u0627\u062f\u0647 \u0627\u0633\u062a! \u0644\u0637\u0641\u0627 \u0628\u0639\u062f \u0627\u0632 \u0628\u0627\u0631\u06af\u0630\u0627\u0631\u06cc \u0645\u062c\u062f\u062f \u0635\u0641\u062d\u0647 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f.");
setTimeout(function(){window.location.reload()},3E3)},timeout:6E4})});$("#verify_form").submit(function(b){b.preventDefault();b.stopImmediatePropagation();b=$(this).serializeArray();var d=$(this).attr("action");$.ajax({url:d,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",cache:!1,dataType:"json",data:b,beforeSend:function(){$(".auth_popup .verify_section .popup_submit_btn").addClass("inprocess");$(".auth_popup .verify_section .popup_submit_btn").prop("disabled",
!0)},success:function(a){$.isEmptyObject(a.error)?(console.log(a),a=$("#verify_form").attr("data-redirect"),a||(a=$('meta[property="og:url"]').attr("content"),a+="/dashboard?wellcome=1"),window.location.href=a):($(".auth_popup .verify_section .popup_submit_btn").removeClass("inprocess"),$(".auth_popup .verify_section .popup_submit_btn").prop("disabled",!1),$(".auth_popup .verify_section .main_error").removeClass("has-error"),$(".auth_popup .verify_section .main_error").text(""),console.log(a.error),
$.isEmptyObject(a.error.verify)||($(".auth_popup .verify_section .main_error").addClass("has-error"),$(".auth_popup .verify_section .main_error").text(a.error.verify)),$.isEmptyObject(a.error.mobile)||($(".auth_popup .verify_section .main_error").addClass("has-error"),$(".auth_popup .verify_section .main_error").text(a.error.verify)))},error:function(a){console.log(a.responseText);c(encodeURI(a.responseText.slice(0,1500)));$(".auth_popup .verify_section .popup_submit_btn").removeClass("inprocess");
$(".auth_popup .verify_section .popup_submit_btn").prop("disabled",!1);$(".auth_popup .verify_section .main_error").addClass("has-error");$(".auth_popup .verify_section .main_error").text("\u062f\u0631 \u0627\u062a\u0635\u0627\u0644 \u0634\u0645\u0627 \u0628\u0647 \u0633\u0631\u0648\u0631 \u062e\u0637\u0627\u06cc\u06cc \u0631\u062e \u062f\u0627\u062f\u0647 \u0627\u0633\u062a! \u0644\u0637\u0641\u0627 \u0628\u0639\u062f \u0627\u0632 \u0628\u0627\u0631\u06af\u0630\u0627\u0631\u06cc \u0645\u062c\u062f\u062f \u0635\u0641\u062d\u0647 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f.");
setTimeout(function(){window.location.reload()},3E3)},timeout:6E4})})});